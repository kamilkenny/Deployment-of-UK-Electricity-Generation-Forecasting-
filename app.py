# -*- coding: utf-8 -*-
"""app.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/19G_xR-Kvz8hHcMeFwQv4FuTn9wjlQKGC
"""

import streamlit as st
import pandas as pd
import joblib
import datetime
from PIL import Image

# 1. Page Configuration
st.set_page_config(
    page_title="UK Generation Forecast | Kamil Kehinde",
    page_icon="âš¡",
    layout="wide"
)

# 2. Sidebar - Modeller Branding
with st.sidebar:
    # Display your personal picture
    try:
        profile_img = Image.open("kamil_profile.jpg")
        st.image(profile_img, width=150, caption="Kamil Kehinde")
    except FileNotFoundError:
        st.warning("Profile image not found. Please add 'kamil_profile.jpg' to the folder.")

    st.header("ðŸ‘¤ Modeller Information")
    st.write("**Name:** Kamil Kehinde")
    st.write("**Role:** Data Scientist / Energy Analyst")
    st.write("**Project:** NESO Energy Case Study")
    st.divider()
    st.info("This model predict grid generation.")

# 3. Main Header & Case Study Title
col1, col2 = st.columns([3, 1])

with col1:
    st.title("âš¡ UK Electricity Generation Forecaster")
    st.markdown("### Case Study: High-Resolution Univariate Time Series Modeling")
    st.write(f"""
    **Modeller:** Kamil Kehinde
    **Last Data Point:** 14-02-2026

    This dashboard presents a specialized machine learning approach to UK grid management.
    By training on historical patterns, we can project future generation needs
    without requiring external fuel-source data.
    """)

with col2:
    # A generic grid image to set the scene
    st.image("https://images.unsplash.com/photo-1466611653911-95081537e5b7?q=80&w=500",
             caption="Sustainable Energy Management")

st.divider()

# 4. Model Loading (Cached)
@st.cache_resource
def load_model():
    return joblib.load('gb_gen_time_only.pkl')

model = load_model()

# 5. Prediction Section
st.subheader("ðŸ“… Target Horizon Selection")
c1, c2 = st.columns(2)
with c1:
    target_date = st.date_input("Select Date", datetime.date(2026, 3, 1))
with c2:
    target_time = st.time_input("Select Time", datetime.time(12, 0))

# Prepare Features
dt = datetime.datetime.combine(target_date, target_time)
input_data = pd.DataFrame({
    'hour': [dt.hour],
    'dayofweek': [dt.weekday()],
    'month': [dt.month],
    'year': [dt.year]
})

# 6. Execute Forecast
if st.button("Generate Forecast", type="primary"):
    prediction = model.predict(input_data)[0]

    st.success(f"Forecast Generated for {dt.strftime('%A, %d %B %Y')}")
    st.metric(label="Predicted Total Generation", value=f"{prediction:,.2f} MW")

    # Simple Visual feedback
    st.progress(min(int(prediction/40000 * 100), 100))
    st.caption(f"Grid Load Intensity: {prediction/40000:.1%}")